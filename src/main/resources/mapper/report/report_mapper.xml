<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd"
>
<mapper namespace="com.sulbazi.report.ReportDAO">
	<!-- <select id="reportList">
		SELECT reported_id, reporting_id, report_category, report_content, report_date, report_state
		FROM report ORDER BY report_idx DESC LIMIT #{param1} OFFSET #{param2}
	</select>
	<select id="allCount" resultType="int">
		SELECT CEIL(COUNT(report_idx)/#{param1}) FROM report
	</select> -->
	<select id="reportList" resultType="com.sulbazi.report.ReportDTO">
    SELECT * FROM report WHERE (#{status} = 'all' OR report_state = #{status})
    	AND (#{category} IS NULL OR report_category = #{category})
    	ORDER BY report_idx DESC LIMIT #{limit} OFFSET #{offset}
</select>
<select id="allCount" resultType="int">
    SELECT COUNT(*) FROM report WHERE (#{status} = 'all' OR report_state = #{status})
    	AND (#{category} IS NULL OR report_category = #{category})
</select>
	<select id="reportDetail" resultType="com.sulbazi.report.ReportDTO">
		SELECT * FROM report WHERE report_idx = #{report_idx}
	</select>
	<insert id="reportWrite" parameterType="com.sulbazi.report.ProcessDTO">
		INSERT INTO process(report_idx, admin_id, process_content, process_result)
			VALUES(#{report_idx},#{admin_id},#{process_content},#{process_result})
	</insert>
</mapper>